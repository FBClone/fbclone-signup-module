<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="bower_components/polymerfire/firebase-document.html">

<dom-module id = "fbclone-signup-module">
    <template>
        <style>
            :host {
                position: relative;
                left: 35%;
            }

            .signUp {
                margin-left: 5%;
                margin-right: 5%;
                margin-bottom: 5%;
            }

            #signUpForm {
                width: 25%;
            }

            #submit {
                border: 1px black solid;
                background-color: lightgray;
                margin-left: 69%;
                margin-top: 3%;
            }
        </style>

        <firebase-document
            app-name="[[appName]]"
            path="/system"
            data="{{account}}"></firebase-document>

        <div id = "signUpForm">
            <paper-input
                    label="First Name"
                    id="firstName"
                    class="signUp"
                    value="{{firstName}}"></paper-input>

            <paper-input
                    label="Last Name"
                    id="lastName"
                    class="signUp"
                    value="{{lastName}}"></paper-input>

            <paper-input
                    label="Age"
                    id="age"
                    class="signUp"
                    type="number"
                    value="{{age}}"></paper-input>

            <paper-input
                    label="Email"
                    id="email"
                    class="signUp"
                    value="{{email}}"></paper-input>

            <paper-button id="submit" on-tap="submitForm">Submit</paper-button>
        </div>
    </template>

    <script>
        Polymer({
            is: "fbclone-signup-module",

            properties: {
                firstName: {
                    type: String,
                    notify: true
                },

                lastName: {
                    type: String,
                    notify: true
                },

                age: {
                    type: Number,
                    notify: true
                },

                email: {
                    type: String,
                    notify: true
                },

                account: {
                    type: Object,
                    notify: true,
                    value: {
                        firstName: this.firstName,
                        lastName: this.lastName,
                        age: this.age,
                        email: this.email
                    }
                }

            },

            submitForm: function() {

                var package = {
                    'contact': {
                        'first_name': this.firstName,
                        'last_name': this.lastName,
                        'age': this.age,
                        'email': this.email
                    }
                };

                var req = new XMLHttpRequest();
                req.open('POST', 'https://fbclone-c6f27.firebaseio.com' + '/users');
                req.setRequestHeader('Content-Type', 'application/json');

                req.onload = function() {
                    if (req.status === 200 || req.status === 204 || req.status === 304) {
                        console.log('successful firebase submission');
                    } else if (req.status >= 400 && req.status < 500) {
                        console.log('error with submission');
                    } else if (req.status >= 500 && req.status < 600) {
                        console.log('server error');
                    }
                };

                req.send(JSON.stringify(package));
            }
        });
    </script>
</dom-module>